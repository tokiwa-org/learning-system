# IPv4アドレスの仕組み

## メタ情報

```yaml
mission: "ネットワークの仕組みを解明しよう"
step: 2
subStep: 2
title: "IPv4アドレスの仕組み"
itemType: LESSON
estimatedMinutes: 30
noiseLevel: MINIMAL
roadmap:
  skill: "ネットワーク"
  category: "IT基本"
  target_level: "L0"
```

---

## ストーリー

> 「先輩、192.168.1.1 って数字はどういう意味があるんですか？」
>
> 「いい質問だね。あの数字にはちゃんとルールがあるんだ」
>
> 「ルール？」
>
> 「そう。4つの数字の意味や、どの範囲が使えるかが決まっているんだよ」

---

## IPv4アドレスの形式

### 基本形式

```
192.168.1.1
```

- **4つの数字** をドット（.）で区切る
- 各数字は **0〜255** の範囲
- この4つの数字のまとまりを **オクテット** と呼ぶ

### なぜ0〜255なのか

各オクテットは **8ビット（1バイト）** で表現されます。

```
8ビットで表せる範囲:
00000000 = 0
11111111 = 255
```

### 2進数と10進数の対応

```
10進数:  192    .  168    .  1      .  1
2進数:   11000000  10101000  00000001  00000001
```

合計 **32ビット** で1つのIPv4アドレスを表します。

---

## ネットワーク部とホスト部

IPアドレスは **ネットワーク部** と **ホスト部** の2つに分かれます。

```
192.168.1.100
├─────────┤ ├┤
ネットワーク部  ホスト部
```

### 住所の例え

```
東京都千代田区丸の内 1-1-1
├─────────────────┤ ├───┤
町名まで = ネットワーク部   番地 = ホスト部
```

- **ネットワーク部**: どのネットワークに属するか（町名）
- **ホスト部**: そのネットワーク内のどのコンピュータか（番地）

### 同じネットワークかどうかの判別

```
PC-A:  192.168.1.10   → ネットワーク: 192.168.1.0
PC-B:  192.168.1.20   → ネットワーク: 192.168.1.0  ← 同じ！
PC-C:  192.168.2.10   → ネットワーク: 192.168.2.0  ← 違う！
```

ネットワーク部が同じなら、同じネットワーク（LAN）内にいます。

---

## IPアドレスのクラス（参考）

歴史的に、IPアドレスはクラスに分けられていました。

| クラス | 範囲 | ネットワーク部 | 用途 |
|--------|------|--------------|------|
| クラスA | 1.0.0.0 〜 126.255.255.255 | 最初の1オクテット | 大規模ネットワーク |
| クラスB | 128.0.0.0 〜 191.255.255.255 | 最初の2オクテット | 中規模ネットワーク |
| クラスC | 192.0.0.0 〜 223.255.255.255 | 最初の3オクテット | 小規模ネットワーク |

現在はクラスの概念はあまり使われず、**CIDR** というより柔軟な方法が主流です（次のセクションで解説）。

---

## IPアドレスの枯渇問題

### IPv4アドレスの総数

```
32ビット = 2^32 = 約43億個
```

世界の人口は約80億人。スマホ、PC、IoT機器...43億個では全然足りません。

### どう対処しているか

| 対策 | 説明 |
|------|------|
| **プライベートIP + NAT** | 1つのグローバルIPを複数機器で共有 |
| **IPv6** | 新しいアドレス体系（ほぼ無限のアドレス数） |
| **CIDR** | IPアドレスを効率的に割り当てる仕組み |

---

## IPアドレスの割り当て

### 自動割り当て（DHCP）

通常、IPアドレスは **DHCP** サーバーによって自動的に割り当てられます。

```
[あなたのPC] ──「IPアドレスください」──> [DHCPサーバー（ルーター）]
[あなたのPC] <──「192.168.1.10を使って」── [DHCPサーバー（ルーター）]
```

- Wi-Fiに接続するだけで自動でIPアドレスが割り当てられる
- 接続するたびに異なるIPアドレスが割り当てられることもある

### 固定割り当て（静的IP）

サーバーなど、常に同じIPアドレスが必要な場合は手動で設定します。

```
Webサーバー: 192.168.1.100（常にこのアドレス）
```

---

## まとめ

| ポイント | 内容 |
|----------|------|
| IPv4の形式 | 4つのオクテット（0〜255）をドットで区切る |
| ネットワーク部 | どのネットワークに属するかを表す |
| ホスト部 | ネットワーク内のどの機器かを表す |
| アドレス数 | 約43億個（現在は枯渇状態） |
| DHCP | IPアドレスを自動で割り当てる仕組み |

### チェックリスト
- [ ] IPv4アドレスの形式（4オクテット、0〜255）を理解した
- [ ] ネットワーク部とホスト部の違いが分かる
- [ ] IPv4アドレスが約43億個しかないことを知った
- [ ] DHCPによる自動割り当ての仕組みを理解した

---

## 次のステップへ

IPv4アドレスの基本構造が分かりましたね。

次のセクションでは、**サブネットマスク** と **プライベートIP** について学びます。ネットワーク部とホスト部の境界をどう決めるのか、詳しく見ていきましょう。

---

*推定読了時間: 30分*

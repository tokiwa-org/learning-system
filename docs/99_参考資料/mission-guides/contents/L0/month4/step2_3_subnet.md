# サブネットとプライベートIP

## メタ情報

```yaml
mission: "ネットワークの仕組みを解明しよう"
step: 2
subStep: 3
title: "サブネットとプライベートIP"
itemType: LESSON
estimatedMinutes: 30
noiseLevel: MINIMAL
roadmap:
  skill: "ネットワーク"
  category: "IT基本"
  target_level: "L0"
```

---

## ストーリー

> 「先輩、ネットワーク部とホスト部の境界はどうやって決まるんですか？」
>
> 「それを決めるのがサブネットマスクだよ」
>
> 「サブネットマスク...聞いたことはあります」
>
> 「あとプライベートIPっていう特別な範囲もあるんだ。実はよく使ってるよ」

---

## サブネットマスクとは

### 一言で言うと

**IPアドレスのネットワーク部とホスト部の境界を示す値**

### 仕組み

```
IPアドレス:      192.168.1.100
サブネットマスク:  255.255.255.0
                 ├─────────┤ ├┤
                 ネットワーク   ホスト
```

サブネットマスクの「255」の部分がネットワーク部、「0」の部分がホスト部です。

### 2進数で見ると

```
サブネットマスク: 255.255.255.0
2進数:          11111111.11111111.11111111.00000000
                ├────── 1の部分 ──────┤├ 0の部分 ┤
                ネットワーク部(24ビット)  ホスト部(8ビット)
```

- **1が続く部分** = ネットワーク部
- **0が続く部分** = ホスト部

---

## CIDR表記

サブネットマスクをスラッシュと数字で表す書き方を **CIDR（サイダー）表記** と言います。

```
192.168.1.0/24
             └── ネットワーク部が24ビット
```

### よく使うCIDR

| CIDR | サブネットマスク | ホスト数 | 用途 |
|------|----------------|---------|------|
| /8 | 255.0.0.0 | 約1670万 | 大規模ネットワーク |
| /16 | 255.255.0.0 | 約65,000 | 中規模ネットワーク |
| /24 | 255.255.255.0 | 254 | 小規模ネットワーク（家庭・小規模オフィス） |
| /32 | 255.255.255.255 | 1 | 特定のホスト1台 |

### なぜ/24で254台なのか

```
ホスト部 = 8ビット = 256通り（0〜255）
- 0: ネットワークアドレス（使用不可）
- 255: ブロードキャストアドレス（使用不可）
= 254台が使用可能
```

---

## サブネットの役割

### なぜサブネットに分けるのか

大きなネットワークを小さく分割して、管理しやすくします。

```
分割前:
[全社員1000台が1つのネットワーク] ← 管理が大変、通信が混雑

分割後:
[営業部 /24]  ← 254台まで
[開発部 /24]  ← 254台まで
[総務部 /24]  ← 254台まで
[経理部 /24]  ← 254台まで
```

部署ごとにサブネットを分けることで：
- 通信が分離される（混雑軽減）
- セキュリティを部署単位で管理できる
- トラブルの影響範囲を限定できる

---

## プライベートIPアドレス

インターネット上では使えない、**LAN内専用** のIPアドレス範囲です。

### プライベートIPの3つの範囲

| クラス | 範囲 | CIDR | 用途 |
|--------|------|------|------|
| クラスA | 10.0.0.0 〜 10.255.255.255 | 10.0.0.0/8 | 大企業、クラウド（AWS VPCなど） |
| クラスB | 172.16.0.0 〜 172.31.255.255 | 172.16.0.0/12 | 中規模企業 |
| クラスC | 192.168.0.0 〜 192.168.255.255 | 192.168.0.0/16 | 家庭、小規模オフィス |

### 家庭でよく見るIPアドレス

```
ルーター:  192.168.1.1    または  192.168.0.1
PC:       192.168.1.10
スマホ:    192.168.1.11
```

`192.168.x.x` で始まるアドレスは、すべてプライベートIPアドレスです。

---

## NAT（Network Address Translation）

プライベートIPだけではインターネットに接続できません。そこで **NAT** が登場します。

### NATの仕組み

```
[PC: 192.168.1.10] ──リクエスト──> [ルーター] ──変換──> [インターネット]
  プライベートIP                   NAT変換          グローバルIP: 203.0.113.1
```

1. PCがプライベートIP（192.168.1.10）でリクエストを送る
2. ルーターがグローバルIP（203.0.113.1）に変換してインターネットに送る
3. レスポンスが返ってきたら、ルーターがプライベートIPに戻してPCに届ける

### マンションの例え

```
部屋番号（101号室、102号室）→ プライベートIP
マンションの住所            → グローバルIP

外部からの荷物は「マンションの住所」宛てに届き、
管理人（ルーター）が「101号室」に届ける
```

### NATのメリット

- 1つのグローバルIPを複数の機器で共有できる
- IPv4アドレスの枯渇対策になる
- LAN内の機器を外部から直接アクセスされにくい（セキュリティ）

---

## まとめ

| ポイント | 内容 |
|----------|------|
| サブネットマスク | ネットワーク部とホスト部の境界を決める |
| CIDR表記 | /24 のようにビット数で表記（/24 = 254台） |
| プライベートIP | LAN内専用のアドレス（192.168.x.x など） |
| NAT | プライベートIPとグローバルIPを変換する仕組み |

### チェックリスト
- [ ] サブネットマスクの役割を理解した
- [ ] CIDR表記（/24 など）の意味が分かる
- [ ] プライベートIPの3つの範囲を知っている
- [ ] NATの仕組みを説明できる

---

## 次のステップへ

サブネットとプライベートIPが理解できましたね。

次のセクションでは、IPv4の後継である **IPv6** について学びます。なぜ新しいアドレス体系が必要なのか、見ていきましょう。

---

*推定読了時間: 30分*

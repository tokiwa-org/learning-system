# 制約条件

---

## 1. 概要

本書は、人事考課システムの設計・開発・運用における制約条件を定義する。

---

## 2. ビジネス制約

### 2.1 予算制約

| 項目             | 制約     | 備考           |
| ---------------- | -------- | -------------- |
| インフラ初期費用 | $0       | 無料枠内で開始 |
| インフラ月額費用 | $100以下 | フェーズ2まで  |
| 開発人件費       | 内製     | 外部委託なし   |
| ライセンス費     | 最小化   | OSS優先        |

### 2.2 スケジュール制約

| マイルストーン    | 期限       | 備考                   |
| ----------------- | ---------- | ---------------------- |
| 要件定義完了      | 2026年Q1末 | グランドデザイン含む   |
| フェーズ1リリース | 2026年Q3   | 年次評価に間に合わせる |
| フェーズ2リリース | 2027年Q1   | 次年度開始時           |

### 2.3 組織制約

| 制約         | 詳細                          |
| ------------ | ----------------------------- |
| 開発リソース | 専任1名 + 兼務1名             |
| 運用体制     | IT部門の専任運用者なし        |
| 意思決定     | 人事部門の承認が必要          |
| 評価制度変更 | 既存の職級制度（L1-L5）は維持 |

---

## 3. 技術制約

### 3.1 プラットフォーム制約

| 項目           | 制約              | 理由                         |
| -------------- | ----------------- | ---------------------------- |
| インフラ       | Cloudflare限定    | 既存契約、コスト最適化       |
| データベース   | D1 + Neo4j Aura   | Cloudflare統合、グラフDB必須 |
| 言語/FW        | TypeScript + Hono | Cloudflare Workers対応       |
| フロントエンド | React or Vue      | チーム経験                   |

### 3.2 Cloudflare制約

| サービス     | 制約             | 影響                        |
| ------------ | ---------------- | --------------------------- |
| Workers Free | 100,000 req/日   | 十分な余裕あり              |
| Workers Free | CPU時間 10ms/req | 複雑な処理は分割            |
| D1 Free      | 5GB              | 当面は十分                  |
| D1           | SQLite互換       | ストアドプロシージャ不可    |
| Pages        | 500ビルド/月     | CI/CDパイプライン設計に影響 |

### 3.3 Neo4j Aura Free制約

| 制約                 | 値                  | 影響             |
| -------------------- | ------------------- | ---------------- |
| ノード数             | 200,000             | 十分             |
| リレーションシップ数 | 400,000             | 十分             |
| ストレージ           | 無制限（Free Tier） | -                |
| インスタンス停止     | 30日無活動で停止    | 定期アクセス必要 |
| バックアップ         | 手動のみ            | 運用で対応       |
| APOC                 | 利用可能            | -                |

### 3.4 LLM制約（フェーズ2）

| 制約           | 詳細                             |
| -------------- | -------------------------------- |
| API選択        | Claude API または Amazon Bedrock |
| コスト         | トークン従量課金                 |
| レートリミット | API制限に準拠                    |
| 生成品質       | 有識者査閲を必須化               |
| 機密情報       | 社員名等をプロンプトに含めない   |

---

## 4. セキュリティ制約

### 4.1 データ取り扱い制約

| 制約               | 詳細                         |
| ------------------ | ---------------------------- |
| 個人情報の外部送信 | LLMへの社員名送信禁止        |
| データ保存地域     | 国内優先（Cloudflare設定）   |
| 暗号化             | 保存時・通信時ともに必須     |
| アクセス制御       | ロールベースアクセス制御必須 |

### 4.2 認証制約

| 制約           | 詳細                  |
| -------------- | --------------------- |
| SSO            | Cloudflare Access利用 |
| 外部認証連携   | Google Workspace      |
| ゲストアクセス | 不可                  |

---

## 5. 運用制約

### 5.1 運用時間

| 項目             | 制約           |
| ---------------- | -------------- |
| サービス提供時間 | 24時間365日    |
| サポート対応時間 | 平日9:00-18:00 |
| 計画メンテナンス | 日曜深夜のみ   |

### 5.2 運用体制制約

| 制約       | 詳細                           |
| ---------- | ------------------------------ |
| 専任運用者 | なし（開発チームが兼務）       |
| 24時間監視 | 不可（アラートで対応）         |
| 障害対応   | 翌営業日対応（Criticalを除く） |

---

## 6. 既存システム制約

### 6.1 連携制約

| システム     | 連携要否            | 制約                 |
| ------------ | ------------------- | -------------------- |
| 給与システム | 連携なし            | スコープ外           |
| 勤怠システム | 連携なし            | スコープ外           |
| 社員マスタ   | 初期インポートのみ  | リアルタイム連携なし |
| メール       | 通知用（フェーズ2） | SMTP設定必要         |

### 6.2 データ整合性制約

| 制約       | 詳細                 |
| ---------- | -------------------- |
| 社員マスタ | 給与システムが正     |
| 職級変更   | 人事部門での手動更新 |
| 重複管理   | 社員IDでの一意性確保 |

---

## 7. 規制・コンプライアンス制約

### 7.1 法的制約

| 制約           | 対応                 |
| -------------- | -------------------- |
| 個人情報保護法 | 利用目的の特定・同意 |
| 労働関連法規   | 評価の公平性担保     |
| 社内規程       | 人事評価規程に準拠   |

### 7.2 監査対応制約

| 制約         | 対応                       |
| ------------ | -------------------------- |
| 監査ログ     | 全更新操作のログ保持       |
| 証跡保管     | 評価確定データの改ざん防止 |
| アクセス履歴 | 1年間保持                  |

---

## 8. 設計・開発制約

### 8.1 アーキテクチャ制約

| 制約         | 理由                   |
| ------------ | ---------------------- |
| サーバーレス | Cloudflare Workers前提 |
| ステートレス | Workers制約            |
| エッジ実行   | D1ローカル接続のみ     |

### 8.2 コーディング制約

| 制約       | 詳細                |
| ---------- | ------------------- |
| 言語       | TypeScript必須      |
| Linter     | ESLint + Prettier   |
| テスト     | Vitest              |
| カバレッジ | 80%以上（主要機能） |

### 8.3 リポジトリ制約

| 制約           | 詳細                     |
| -------------- | ------------------------ |
| バージョン管理 | Git（GitHub）            |
| ブランチ戦略   | GitHub Flow              |
| コミット       | Conventional Commits     |
| レビュー       | マージ前にPRレビュー必須 |

---

## 9. 移行制約

### 9.1 データ移行制約

| 制約         | 詳細                        |
| ------------ | --------------------------- |
| 移行期間     | 1ヶ月以内                   |
| 並行運用     | 最小限（2週間）             |
| ロールバック | 移行後1週間は旧システム維持 |

### 9.2 ユーザー移行制約

| 制約       | 詳細                 |
| ---------- | -------------------- |
| 教育期間   | 2週間                |
| マニュアル | オンラインヘルプ必須 |
| サポート   | 移行後1ヶ月は手厚く  |

---

## 10. 制約一覧サマリ

| カテゴリ     | 主要制約                | リスク/影響           |
| ------------ | ----------------------- | --------------------- |
| 予算         | インフラ$0スタート      | 機能制限（Free Tier） |
| スケジュール | Q3リリース              | 機能絞り込み必須      |
| 技術         | Cloudflare限定          | 他PaaS選択不可        |
| 技術         | Neo4j Aura Free         | 30日停止リスク        |
| 運用         | 専任者なし              | 障害対応遅延          |
| セキュリティ | LLMへの個人情報送信禁止 | プロンプト設計制約    |

---

## 11. 制約緩和の検討

### 将来的に緩和可能な制約

| 制約             | 緩和条件   | 緩和後            |
| ---------------- | ---------- | ----------------- |
| インフラ費用$0   | 予算承認   | 有料プラン移行    |
| Neo4j Free       | 予算承認   | Professional Tier |
| 専任運用者なし   | 人員確保   | 運用体制強化      |
| Workers CPU 10ms | 有料プラン | 50ms              |

---

_作成日: 2026年1月24日_ _トキワテック 人事考課システム_
